{"last_node_id":212,"last_link_id":348,"nodes":[{"id":160,"type":"CheckpointLoaderSimple","pos":[1610,30],"size":[315,98],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","localized_name":"MODEL","type":"MODEL","links":[209],"slot_index":0},{"name":"CLIP","localized_name":"CLIP","type":"CLIP","links":[203,205],"slot_index":1},{"name":"VAE","localized_name":"VAE","type":"VAE","links":[212],"slot_index":2}],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["RealVisXL_V5.0_fp16.safetensors"]},{"id":183,"type":"easy showAnything","pos":[1620,-360],"size":[420,220],"flags":{},"order":11,"mode":0,"inputs":[{"name":"anything","localized_name":"anything","type":"*","shape":7,"link":247}],"outputs":[{"name":"output","localized_name":"output","type":"*","links":[],"slot_index":0}],"properties":{"cnr_id":"comfyui-easy-use","ver":"1.2.7","Node name for S&R":"easy showAnything"},"widgets_values":["{\n  \"filename\": \"D:/YANG/Comfy/ComfyUI/input/1-LHS009K03_comfy_00012_ (1).png\",\n  \"resolution\": \"1024x1024\",\n  \"date\": \"2025-03-07 11:19:21.745463\",\n  \"size\": \"1.31 MB\"\n}"]},{"id":178,"type":"Metadata extractor [Crystools]","pos":[1630,-540],"size":[355.20001220703125,126],"flags":{},"order":10,"mode":0,"inputs":[{"name":"metadata_raw","localized_name":"metadata_raw","type":"METADATA_RAW","link":242}],"outputs":[{"name":"prompt","localized_name":"prompt","type":"JSON","links":null},{"name":"workflow","localized_name":"workflow","type":"JSON","links":null,"slot_index":1},{"name":"file info","localized_name":"file info","type":"JSON","links":[247,250],"slot_index":2},{"name":"raw to JSON","localized_name":"raw to JSON","type":"JSON","links":null},{"name":"raw to property","localized_name":"raw to property","type":"STRING","links":null},{"name":"raw to csv","localized_name":"raw to csv","type":"STRING","links":null}],"properties":{"cnr_id":"comfyui-crystools","ver":"72e2e9af4a6b9a58ca5d753cacff37ba1ff9bfa8","Node name for S&R":"Metadata extractor [Crystools]"},"widgets_values":[]},{"id":166,"type":"Reroute","pos":[1360,30],"size":[75,26],"flags":{},"order":16,"mode":2,"inputs":[{"name":"","type":"*","link":344}],"outputs":[{"name":"","type":"IMAGE","links":[215,216,312],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":196,"type":"ThresholdMask","pos":[1220,-110],"size":[315,58],"flags":{},"order":18,"mode":0,"inputs":[{"name":"mask","localized_name":"mask","type":"MASK","link":343}],"outputs":[{"name":"MASK","localized_name":"MASK","type":"MASK","links":[319],"slot_index":0}],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"ThresholdMask"},"widgets_values":[0.33]},{"id":198,"type":"LayerUtility: ImageBlend","pos":[2830,230],"size":[315,146],"flags":{},"order":25,"mode":0,"inputs":[{"name":"background_image","localized_name":"background_image","type":"IMAGE","link":324},{"name":"layer_image","localized_name":"layer_image","type":"IMAGE","link":323},{"name":"layer_mask","localized_name":"layer_mask","type":"MASK","shape":7,"link":322}],"outputs":[{"name":"image","localized_name":"image","type":"IMAGE","links":[325,326,347],"slot_index":0}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"7b326d13e43fc4022cd80e472c7af67027409b1e","Node name for S&R":"LayerUtility: ImageBlend"},"widgets_values":[true,"normal",100],"color":"rgba(38, 73, 116, 0.7)"},{"id":190,"type":"LayerUtility: Florence2Image2Prompt","pos":[1160,250],"size":[378,200],"flags":{},"order":20,"mode":2,"inputs":[{"name":"florence2_model","localized_name":"florence2_model","type":"FLORENCE2","link":311},{"name":"image","localized_name":"image","type":"IMAGE","link":312}],"outputs":[{"name":"text","localized_name":"text","type":"STRING","links":[313],"slot_index":0},{"name":"preview_image","localized_name":"preview_image","type":"IMAGE","links":null}],"properties":{"aux_id":"chflame163/ComfyUI_LayerStyle_Advance","ver":"8e30d7d64f879928af812a8aa6de02c8524bdb9d","Node name for S&R":"LayerUtility: Florence2Image2Prompt"},"widgets_values":["generate tags(PromptGen 1.5)","",1024,3,false,false],"color":"rgba(38, 73, 116, 0.7)"},{"id":159,"type":"CLIPTextEncode","pos":[2080,40],"size":[270,59],"flags":{},"order":9,"mode":0,"inputs":[{"name":"clip","localized_name":"clip","type":"CLIP","link":205},{"name":"text","type":"STRING","widget":{"name":"text"},"link":333}],"outputs":[{"name":"CONDITIONING","localized_name":"CONDITIONING","type":"CONDITIONING","links":[210],"slot_index":0}],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"CLIPTextEncode"},"widgets_values":["(masterpiece: 1,2), best quality, masterpiece, highres, original, extremely detailed wallpaper, perfect lighting, (extremely detailed CG: 1.2),  ",[false,true]]},{"id":167,"type":"PreviewImage","pos":[2830,440],"size":[210,246],"flags":{},"order":21,"mode":0,"inputs":[{"name":"images","localized_name":"images","type":"IMAGE","link":217}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":197,"type":"LayerUtility: ImageMaskScaleAs","pos":[2830,-30],"size":[415.8000183105469,162],"flags":{},"order":22,"mode":0,"inputs":[{"name":"scale_as","localized_name":"scale_as","type":"*","link":330},{"name":"image","localized_name":"image","type":"IMAGE","shape":7,"link":null},{"name":"mask","localized_name":"mask","type":"MASK","shape":7,"link":319}],"outputs":[{"name":"image","localized_name":"image","type":"IMAGE","links":[323,328],"slot_index":0},{"name":"mask","localized_name":"mask","type":"MASK","links":[322],"slot_index":1},{"name":"original_size","localized_name":"original_size","type":"BOX","links":null},{"name":"widht","localized_name":"widht","type":"INT","links":null},{"name":"height","localized_name":"height","type":"INT","links":null}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"7b326d13e43fc4022cd80e472c7af67027409b1e","Node name for S&R":"LayerUtility: ImageMaskScaleAs"},"widgets_values":["letterbox","lanczos"],"color":"rgba(38, 73, 116, 0.7)"},{"id":164,"type":"UltimateSDUpscale","pos":[2460,30],"size":[315,826],"flags":{},"order":19,"mode":0,"inputs":[{"name":"image","localized_name":"image","type":"IMAGE","link":216},{"name":"model","localized_name":"model","type":"MODEL","link":209},{"name":"positive","localized_name":"positive","type":"CONDITIONING","link":210},{"name":"negative","localized_name":"negative","type":"CONDITIONING","link":211},{"name":"vae","localized_name":"vae","type":"VAE","link":212},{"name":"upscale_model","localized_name":"upscale_model","type":"UPSCALE_MODEL","link":213}],"outputs":[{"name":"IMAGE","localized_name":"IMAGE","type":"IMAGE","links":[217,324,330],"slot_index":0}],"properties":{"cnr_id":"comfyui_ultimatesdupscale","ver":"8642daf6281e4ebbdf2daca18539c0ab6c2c63f4","Node name for S&R":"UltimateSDUpscale","aux_id":"ssitu/ComfyUI_UltimateSDUpscale"},"widgets_values":[2,388552696408446,"fixed",30,7,"dpmpp_sde_gpu","karras",0.2,"Linear",1024,1024,8,32,"None",0.2,64,8,16,true,false]},{"id":203,"type":"PreviewImage","pos":[3310,-30],"size":[210,246],"flags":{},"order":24,"mode":0,"inputs":[{"name":"images","localized_name":"images","type":"IMAGE","link":328}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":192,"type":"ShowText|pysssss","pos":[1170,520],"size":[350,120],"flags":{},"order":23,"mode":2,"inputs":[{"name":"text","type":"STRING","widget":{"name":"text"},"link":313}],"outputs":[{"name":"STRING","localized_name":"STRING","type":"STRING","shape":6,"links":[],"slot_index":0}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"bbda5e52ad580c13ceaa53136d9c2bed9137bd2e","Node name for S&R":"ShowText|pysssss"},"widgets_values":["","solo, grey hair, 1boy, sitting, grey eyes, white hair, hetero, indoors, cloud, cat, animal, pillow, chair, plant, curtains, animal bed, cat tree, animal focus, cat on top, animal play, cat scratcher, cat toy, cat tower"]},{"id":191,"type":"LayerMask: LoadFlorence2Model","pos":[1190,130],"size":[336,58],"flags":{},"order":1,"mode":2,"inputs":[],"outputs":[{"name":"florence2_model","localized_name":"florence2_model","type":"FLORENCE2","links":[311]}],"properties":{"aux_id":"chflame163/ComfyUI_LayerStyle_Advance","ver":"8e30d7d64f879928af812a8aa6de02c8524bdb9d","Node name for S&R":"LayerMask: LoadFlorence2Model"},"widgets_values":["base-PromptGen-v2.0"],"color":"rgba(27, 80, 119, 0.7)"},{"id":157,"type":"CLIPTextEncode","pos":[2010,150],"size":[425.27801513671875,180.6060791015625],"flags":{},"order":8,"mode":0,"inputs":[{"name":"clip","localized_name":"clip","type":"CLIP","link":203}],"outputs":[{"name":"CONDITIONING","localized_name":"CONDITIONING","type":"CONDITIONING","links":[211],"slot_index":0}],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"CLIPTextEncode"},"widgets_values":["( worst quality :2),( low quality :2),( normal quality :2), lowres , normal quality ,(( monochrome )),(( grayscale )), skin spots , acnes , skin blemishes , age spot ,( ugly :1.331),( duplicate :1.331),( morbid :1.21),( mutilated :1.21),( tranny :1.331), mutated hands ,( poorly drawn hands :1.5), blurry ,( bad anatomy :1.21),( bad proportions :1.331), extra limbs ,( disfigured :1.331),( missing arms :1.331),( extra legs :1.331),( fused fingers :1.61051),( too many fingers :1.61051),( unclear eyes :1.331), lowers , bad hands , missing fingers , extra digit , bad hands , missing fingers ,((( extra arms and legs )))",[false,true]]},{"id":194,"type":"LayerUtility: TextBox","pos":[1650,200],"size":[340,110],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"text","localized_name":"text","type":"STRING","links":[333],"slot_index":0}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"7b326d13e43fc4022cd80e472c7af67027409b1e","Node name for S&R":"LayerUtility: TextBox"},"widgets_values":["(masterpiece: 1,2), best quality, masterpiece, highres, original, extremely detailed wallpaper, perfect lighting, (extremely detailed CG: 1.2),  ",[false,true]],"color":"rgba(38, 73, 116, 0.7)"},{"id":163,"type":"Note","pos":[2090,500],"size":[320,140],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["4x ultrashap 可以获得更加锐利清晰的效果，但是需要更多的时间(+10s），对于temu RESRGAN x2 足够，然后通过提高分块分辨率到1024，降低区块需求\n\n但是注意4x ultrashap是不能商用的"],"color":"#432","bgcolor":"#653"},{"id":162,"type":"UpscaleModelLoader","pos":[2090,380],"size":[315,58],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"UPSCALE_MODEL","localized_name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[213],"slot_index":0}],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"UpscaleModelLoader"},"widgets_values":["RealESRGAN_x2.pth"]},{"id":182,"type":"Load image with metadata [Crystools]","pos":[1600,-1040],"size":[340.20001220703125,354],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[{"name":"image","localized_name":"image","type":"IMAGE","links":[],"slot_index":0},{"name":"mask","localized_name":"mask","type":"MASK","links":null},{"name":"prompt","localized_name":"prompt","type":"JSON","links":null},{"name":"Metadata RAW","localized_name":"Metadata RAW","type":"METADATA_RAW","links":[242],"slot_index":3}],"properties":{"cnr_id":"comfyui-crystools","ver":"72e2e9af4a6b9a58ca5d753cacff37ba1ff9bfa8","Node name for S&R":"Load image with metadata [Crystools]"},"widgets_values":["1-LHS009K03_comfy_00012_ (1).png","image"]},{"id":202,"type":"Label (rgthree)","pos":[1500,-1050],"size":[72,24],"flags":{"allow_interaction":true},"order":6,"mode":0,"inputs":[],"outputs":[],"title":"生成图","properties":{"fontSize":24,"fontFamily":"Arial","fontColor":"yellow","textAlign":"left","backgroundColor":"transparent","padding":0,"borderRadius":0},"color":"#fff0","bgcolor":"#fff0"},{"id":210,"type":"ShowText|pysssss","pos":[2010,-590],"size":[315,76],"flags":{},"order":15,"mode":0,"inputs":[{"name":"text","type":"STRING","widget":{"name":"text"},"link":342}],"outputs":[{"name":"STRING","localized_name":"STRING","type":"STRING","shape":6,"links":null}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"bbda5e52ad580c13ceaa53136d9c2bed9137bd2e","Node name for S&R":"ShowText|pysssss"},"widgets_values":["","1-LHS009K03.png"]},{"id":209,"type":"LoadImageFromPath","pos":[1240,-260],"size":[315,78],"flags":{},"order":14,"mode":0,"inputs":[{"name":"image","type":"STRING","widget":{"name":"image"},"link":341}],"outputs":[{"name":"IMAGE","localized_name":"IMAGE","type":"IMAGE","links":[344,345],"slot_index":0},{"name":"MASK","localized_name":"MASK","type":"MASK","links":[343],"slot_index":1}],"properties":{"aux_id":"Chaoses-Ib/ComfyUI_Ib_CustomNodes","ver":"59746dc1f9d5e3f52c13e21dba1aacb82d5f1c2a","Node name for S&R":"LoadImageFromPath"},"widgets_values":["ComfyUI_00001_-assets\\ComfyUI_00001_.png [output]"]},{"id":201,"type":"Label (rgthree)","pos":[1360,-650],"size":[96,24],"flags":{"allow_interaction":true},"order":7,"mode":0,"inputs":[],"outputs":[],"title":"原图可选","properties":{"fontSize":24,"fontFamily":"Arial","fontColor":"yellow","textAlign":"left","backgroundColor":"transparent","padding":0,"borderRadius":0},"color":"#fff0","bgcolor":"#fff0"},{"id":211,"type":"PreviewImage","pos":[1300,-570],"size":[210,246],"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","localized_name":"images","type":"IMAGE","link":345}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":181,"type":"FL_CodeNode","pos":[2100,-440],"size":[620,470],"flags":{"collapsed":true},"order":12,"mode":0,"inputs":[{"name":"0_file info","type":"JSON","link":250},{"name":"input","type":"*","link":null}],"outputs":[{"name":"output_0","localized_name":"output_0","type":"*","links":[245,348],"slot_index":0},{"name":"output_1","localized_name":"output_1","type":"*","links":[341,342],"slot_index":1},{"name":"output_2","localized_name":"output_2","type":"*","links":null},{"name":"output_3","localized_name":"output_3","type":"*","links":null}],"properties":{"cnr_id":"comfyui_fill-nodes","ver":"1.1.1","Node name for S&R":"FL_CodeNode"},"widgets_values":["import json\nimport os\njson_string = inputs[0]\n\n# 解析JSON数据\ndata = json.loads(json_string)\n\n# 提取完整文件名\nfull_filename = data[\"filename\"]\nprint(\"完整文件名:\", full_filename)\n\n# 如果你只想要文件名部分（不包括路径）\nimport os\nfilename_only = os.path.basename(full_filename)\nprint(\"仅文件名:\", filename_only)\n\n# 如果你想要不带扩展名的文件名\nfilename_without_ext = os.path.splitext(filename_only)[0]\nprint(\"不带扩展名的文件名:\", filename_without_ext)\n\noutputs[0] = filename_without_ext+\"_2k\"\n\n# 获取第一个下划线前面的部分\nif \"_\" in filename_without_ext:\n    prefix = filename_without_ext.split(\"_\", 1)[0]\nelse:\n    # 如果没有下划线，则使用整个文件名\n    prefix = filename_without_ext\n\noutputs[1] = prefix+\".png\"\n","./res/hello.py",false],"color":"#16727c","bgcolor":"#4F0074"},{"id":161,"type":"Image Comparer (rgthree)","pos":[2800,-720],"size":[750,600],"flags":{},"order":27,"mode":0,"inputs":[{"name":"image_a","type":"IMAGE","dir":3,"link":326},{"name":"image_b","type":"IMAGE","dir":3,"link":215}],"outputs":[],"properties":{"cnr_id":"rgthree-comfy","ver":"32142fe476878a354dda6e2d4b5ea98960de3ced","comparer_mode":"Slide"},"widgets_values":[[{"name":"A","selected":true,"url":"/api/view?filename=rgthree.compare._temp_cabbf_00033_.png&type=temp&subfolder=&rand=0.5375632295016362"},{"name":"B","selected":true,"url":"/api/view?filename=rgthree.compare._temp_cabbf_00034_.png&type=temp&subfolder=&rand=0.6088286390655997"}]]},{"id":180,"type":"easy showAnything","pos":[2070,-370],"size":[270,110],"flags":{},"order":13,"mode":0,"inputs":[{"name":"anything","localized_name":"anything","type":"*","shape":7,"link":245}],"outputs":[{"name":"output","localized_name":"output","type":"*","links":null,"slot_index":0}],"properties":{"cnr_id":"comfyui-easy-use","ver":"1.2.7","Node name for S&R":"easy showAnything"},"widgets_values":["1-LHS009K03_comfy_00012_ (1)_2k"]},{"id":212,"type":"Save image with extra metadata [Crystools]","pos":[3200,290],"size":[277.20001220703125,124],"flags":{},"order":28,"mode":0,"inputs":[{"name":"image","localized_name":"image","type":"IMAGE","link":347},{"name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":348}],"outputs":[{"name":"Metadata RAW","localized_name":"Metadata RAW","type":"METADATA_RAW","links":null}],"properties":{"cnr_id":"comfyui-crystools","ver":"72e2e9af4a6b9a58ca5d753cacff37ba1ff9bfa8","Node name for S&R":"Save image with extra metadata [Crystools]"},"widgets_values":["ComfyUI",false,""]},{"id":199,"type":"PreviewImage","pos":[2380,-390],"size":[210,246],"flags":{},"order":26,"mode":0,"inputs":[{"name":"images","localized_name":"images","type":"IMAGE","link":325}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.15","Node name for S&R":"PreviewImage"},"widgets_values":[]}],"links":[[203,160,1,157,0,"CLIP"],[205,160,1,159,0,"CLIP"],[209,160,0,164,1,"MODEL"],[210,159,0,164,2,"CONDITIONING"],[211,157,0,164,3,"CONDITIONING"],[212,160,2,164,4,"VAE"],[213,162,0,164,5,"UPSCALE_MODEL"],[215,166,0,161,1,"IMAGE"],[216,166,0,164,0,"IMAGE"],[217,164,0,167,0,"IMAGE"],[242,182,3,178,0,"METADATA_RAW"],[245,181,0,180,0,"*"],[247,178,2,183,0,"*"],[250,178,2,181,0,"*"],[311,191,0,190,0,"FLORENCE2"],[312,166,0,190,1,"IMAGE"],[313,190,0,192,0,"STRING"],[319,196,0,197,2,"MASK"],[322,197,1,198,2,"MASK"],[323,197,0,198,1,"IMAGE"],[324,164,0,198,0,"IMAGE"],[325,198,0,199,0,"IMAGE"],[326,198,0,161,0,"IMAGE"],[328,197,0,203,0,"IMAGE"],[330,164,0,197,0,"*"],[333,194,0,159,1,"STRING"],[341,181,1,209,0,"STRING"],[342,181,1,210,0,"STRING"],[343,209,1,196,0,"MASK"],[344,209,0,166,0,"*"],[345,209,0,211,0,"IMAGE"],[347,198,0,212,0,"IMAGE"],[348,181,0,212,1,"STRING"]],"groups":[{"id":8,"title":"sdxl两倍放大","bounding":[1580,-70,1700,990],"color":"#3f789e","font_size":24,"flags":{}},{"id":13,"title":"文件保存","bounding":[1580,-670,1140,600],"color":"#3f789e","font_size":24,"flags":{}},{"id":14,"title":"反推关键字","bounding":[1100,-10,480,690],"color":"#8AA","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.9090909090909091,"offset":[-1164.720617713115,1190.6737994648454]},"ue_links":[],"node_versions":{"BizyAir":"13803424ea54e66ca88ed94b2ed931c3fb0df777","comfy-core":"0.3.14","rgthree-comfy":"5d771b8b56a343c24a26e8cea1f0c87c3d58102f","comfyui-kjnodes":"1.0.5","ComfyUI_LayerStyle":"7b326d13e43fc4022cd80e472c7af67027409b1e"}},"version":0.4}